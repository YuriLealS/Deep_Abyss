<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quizz</title>
    <link rel="stylesheet" href="css/root.css">
    <link rel="icon" href="css/img/logo2.png">
    <link rel="stylesheet" href="css/body.css">
    <link rel="stylesheet" href="css/cabecalho.css">
    <link rel="stylesheet" href="css/rodape_quizz.css">
    <link rel="stylesheet" href="css/quizz.css">
    <script src="js/funcoes.js"></script>
</head>
<body onload="validarSessao()">
        <!-- Início Cabeçalho -->

        <div class="cabecalho">
            <div class="container_cabecalho">
                <a href="index_logado.html"><img src="css/img/logo.png" alt="Logo do Site" class="logo_cabecalho"></a>
                    <ul class="itens_cabecalho">
                        <li> <a href="index_logado.html">Home</a></li>
                        <li> <a href="curiosidades.html">Curiosidades</a></li>
                        <li> <a href="quizz.html">Quizz</a></li>
                        <li> <a href="sobre_mim.html">Sobre</a></li>
                        <li>|</li>
                        <li> <a onclick="limparSessao()" style="cursor: pointer;">Log out</a></li>  
                
                    </ul>
            </div>
        </div>
    
<!-- Fim Cabeçalho -->

<!-- --------------------------------------------------------------------------------------------------------- -->

<!-- Inicio corpo -->

        

        <div class="perguntas">
            <button onclick="play()" class="btn_play" id="btn_inicial">INICIAR</button>

                <div class="caixa_perguntas" id="caixas_perguntas">

                    <h2 id="mudar_pergunta">Pergunta <input type="number" id="num" class="sumir" disabled></h2>

                            <div id="pergunta">
                            </div>
                    
                </div>
        </div>

        <div id="analytics">
            <button onclick="finalizar()" class="ranking" id="btn_ranking">Ranking</button>
        </div>

        <div class="alternativas" id="alterna">
                            
            <div class="alternativa_A">
                <input type="radio" id="A" name="fav_language" value="A">
                <label for="A" id="altA">A</label><br>
            </div>

            <div class="alternativa_B"> 
                <input type="radio" id="B" name="fav_language" value="B">
                <label for="B" id="altB">B</label><br>
            </div>

            <div class="alternativa_C">
                <input type="radio" id="C" name="fav_language" value="C">
                <label for="C" id="altC">C</label><br>
            </div>
            
            <div class="alternativa_D">
                <input type="radio" id="D" name="fav_language" value="D">
                <label for="D" id="altD">D</label>
            </div>

        </div>
        
        <div class="botao_confirmar" id="div_confirma1">
            <button onclick="confirmado1()" id="confirmar1" class="confirme">Confirmar Resposta</button>
        </div>

        <div class="botao_confirmar" id="div_confirma2">
            <button onclick="confirmado2()" id="confirmar2" class="confirme">Confirmar Resposta</button>
        </div>

        <div class="botao_confirmar" id="div_confirma3">
            <button onclick="confirmado3()" id="confirmar3" class="confirme">Confirmar Resposta</button>
        </div>

        <div class="botao_confirmar" id="div_confirma4">
            <button onclick="confirmado4()" id="confirmar4" class="confirme">Confirmar Resposta</button>
        </div>

        <div class="botao_confirmar" id="div_confirma5">
            <button onclick="confirmado5()" id="confirmar5" class="confirme">Confirmar Resposta</button>
        </div>
        
        <div class="botao_confirmar" id="div_confirma6">
            <button onclick="confirmado6()" id="confirmar6" class="confirme">Confirmar Resposta</button>
        </div>
        
        <div class="botao_confirmar" id="div_confirma7">
            <button onclick="confirmado7()" id="confirmar7" class="confirme">Confirmar Resposta</button>
        </div>
        
        <div class="botao_confirmar" id="div_confirma8">
            <button onclick="confirmado8()" id="confirmar8" class="confirme">Confirmar Resposta</button>
        </div>
        
        <div class="botao_confirmar" id="div_confirma9">
            <button onclick="confirmado9()" id="confirmar9" class="confirme">Confirmar Resposta</button>
        </div>
        
        <div class="botao_confirmar" id="div_confirma10">
            <button onclick="confirmado10()" id="confirmar10" class="confirme">Finalizar Quizz</button>
        </div>
<!-- --------------------------------------------------------------------------------------------------------- -->

<!--Inicio rodapé -->

    <div class="rodape">
        <img class="logo_rodape" src="css/img/logo.png" alt="">
            <div class="texto_rodape_index">
                <p class="texto_rodape">
                    feito por Yuri Leal Sapuppo
                </p>
                <p class="texto_rodape">
                    faculdade SPTech School
                </p>
            </div>
        <img class="logo_facebook" src="css/img/logo face.png" alt="">
        <img class="logo_insta" src="css/img/logo inst.png" alt="">
        <img class="logo_twitter" src="css/img/logo tt.png" alt="">
    </div>

</body>
</html>

<script>
    var vt_ranking = []
    var acertos = 0
    var erros = 0

    function play() {
        btn_inicial.style.display = 'none'
        mudar_pergunta.style.display = 'block'
        alterna.style.display = 'flex'
        caixas_perguntas.style.display = 'block'
        div_confirma1.style.display = 'flex'
        num.value = '1'
        pergunta.innerHTML = 'Qual desses peixes abaixo é encontrado em todos os oceanos?'

        altA.innerHTML = 'Peixe bolha'
        altB.innerHTML = 'Peixe-Diabo-Negro'
        altC.innerHTML = 'Regaleco'
        altD.innerHTML = 'Tubarão Duende'
    }

    function confirmado1() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (B.checked) {
            acertos++        
            num.value = '2'
            pergunta.innerHTML = 'Qual o nome científico do peixe regaleco?'

            altA.innerHTML = 'Regalecus Giné'
            altB.innerHTML = 'Regalecus Gise'
            altC.innerHTML = 'Regalecus Gesne'
            altD.innerHTML = 'Regaleco'

            div_confirma1.style.display = 'none'
            div_confirma2.style.display = 'flex'

        } else{
            erros++
            num.value = '2'
            pergunta.innerHTML = 'Qual o nome científico do peixe regaleco?'

            altA.innerHTML = 'Regalecus Giné'
            altB.innerHTML = 'Regalecus Gise'
            altC.innerHTML = 'Regalecus Gesne'
            altD.innerHTML = 'Regaleco'

            div_confirma1.style.display = 'none'
            div_confirma2.style.display = 'flex'

        }

    }

    function confirmado2() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (C.checked) {
            acertos++        
            num.value = '3'
            pergunta.innerHTML = 'Qual desses animais o macho é considerado um parasita da fêmea, passando grande parte da sua vida dentro da mesma?'

            altA.innerHTML = 'Peixe-Diabo-Negro'
            altB.innerHTML = 'Peixe-Dragão-Negro'
            altC.innerHTML = 'Lula vampiro do inferno'
            altD.innerHTML = 'Tubarão cobra'

            div_confirma2.style.display = 'none'
            div_confirma3.style.display = 'flex'

        } else{
            erros++
            num.value = '3'
            pergunta.innerHTML = 'Qual desses animais o macho é considerado um parasita da fêmea, passando grande parte da sua vida dentro da mesma?'

            altA.innerHTML = 'Peixe-Diabo-Negro'
            altB.innerHTML = 'Peixe-Dragão-Negro'
            altC.innerHTML = 'Lula vampiro do inferno'
            altD.innerHTML = 'Tubarão cobra'

            div_confirma2.style.display = 'none'
            div_confirma3.style.display = 'flex'
        }

    }

    function confirmado3() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (A.checked) {
            acertos++        
            num.value = '4'
            pergunta.innerHTML = 'Qual desses animais o macho não tem sistema digestivo, nascendo apenas para reproduzir e depois acaba morrendo?'

            altA.innerHTML = 'Peixe-Diabo-Negro'
            altB.innerHTML = 'Peixe-Dragão-Negro'
            altC.innerHTML = 'Lula vampiro do inferno'
            altD.innerHTML = 'Tubarão cobra'

            div_confirma3.style.display = 'none'
            div_confirma4.style.display = 'flex'

        } else{
            erros++
            num.value = '4'
            pergunta.innerHTML = 'Qual desses animais o macho não tem sistema digestivo, nascendo apenas para reproduzir e depois acaba morrendo?'

            altA.innerHTML = 'Peixe-Diabo-Negro'
            altB.innerHTML = 'Peixe-Dragão-Negro'
            altC.innerHTML = 'Lula vampiro do inferno'
            altD.innerHTML = 'Tubarão cobra'

            div_confirma3.style.display = 'none'
            div_confirma4.style.display = 'flex'
        }

    }
    
    function confirmado4() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (B.checked) {
            acertos++        
            num.value = '5'
            pergunta.innerHTML = 'Chlamydoselachus anguineus é o nome científico de qual peixe?'

            altA.innerHTML = 'Tubarão Cobra'
            altB.innerHTML = 'Peixe-Diabo-Negro'
            altC.innerHTML = 'Lula vampiro do inferno'
            altD.innerHTML = 'Tubarão Duende'

            div_confirma4.style.display = 'none'
            div_confirma5.style.display = 'flex'

        } else{
            erros++
            num.value = '5'
            pergunta.innerHTML = 'Chlamydoselachus anguineus é o nome científico de qual peixe?'

            altA.innerHTML = 'Tubarão Cobra'
            altB.innerHTML = 'Peixe-Diabo-Negro'
            altC.innerHTML = 'Lula vampiro do inferno'
            altD.innerHTML = 'Tubarão Duende'

            div_confirma4.style.display = 'none'
            div_confirma5.style.display = 'flex'

        }

    }

    function confirmado5() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (A.checked) {
            acertos++        
            num.value = '6'
            pergunta.innerHTML = 'Sua mordida é extremamente diferente de todos os outro peixes, pois sua mandíbula se desloca para frente'

            altA.innerHTML = 'Tubarão boca grande'
            altB.innerHTML = 'Tubarão Charuto'
            altC.innerHTML = 'Tubarão Cobra'
            altD.innerHTML = 'Tubarão Duende'

            div_confirma5.style.display = 'none'
            div_confirma6.style.display = 'flex'

        } else{
            erros++
            num.value = '6'
            pergunta.innerHTML = 'Sua mordida é extremamente diferente de todos os outro peixes, pois sua mandíbula se desloca para frente '

            altA.innerHTML = 'Tubarão boca grande'
            altB.innerHTML = 'Tubarão Charuto'
            altC.innerHTML = 'Tubarão Cobra'
            altD.innerHTML = 'Tubarão Duende'

            div_confirma5.style.display = 'none'
            div_confirma6.style.display = 'flex'

        }

    }

    function confirmado6() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (D.checked) {
            acertos++        
            num.value = '7'
            pergunta.innerHTML = 'A luz emitida por esta espécie, ao contrário de outras espécies bioluminescentes, encontra-se numa gama que abrange parte do espetro eletromagnético, que inclui radiação infra-vermelha.'

            altA.innerHTML = 'Peixe-Diabo-Negro'
            altB.innerHTML = 'Lula vampiro do inferno'
            altC.innerHTML = 'Peixe-Dragrão-Negro'
            altD.innerHTML = 'Regaleco'

            div_confirma6.style.display = 'none'
            div_confirma7.style.display = 'flex'

        } else{
            erros++
            num.value = '7'
            pergunta.innerHTML = 'A luz emitida por esta espécie, ao contrário de outras espécies bioluminescentes, encontra-se numa gama que abrange parte do espetro eletromagnético, que inclui radiação infra-vermelha.'

            altA.innerHTML = 'Peixe-Diabo-Negro'
            altB.innerHTML = 'Lula vampiro do inferno'
            altC.innerHTML = 'Peixe-Dragrão-Negro'
            altD.innerHTML = 'Regaleco'

            div_confirma6.style.display = 'none'
            div_confirma7.style.display = 'flex'

        }

    }


    function confirmado7() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (C.checked) {
            acertos++        
            num.value = '8'
            pergunta.innerHTML = 'Em quais oceanos a Lula vampiro do inferno pode ser encontrada?'

            altA.innerHTML = 'Índico e Atlântico'
            altB.innerHTML = 'Atlântico e Glacial Ártico'
            altC.innerHTML = 'Índico'
            altD.innerHTML = 'Pacífico e Atlântico'

            div_confirma7.style.display = 'none'
            div_confirma8.style.display = 'flex'

        } else{
            erros++
            num.value = '8'
            pergunta.innerHTML = 'Em quais oceanos a Lula vampiro do inferno pode ser encontrada?'

            altA.innerHTML = 'Índico e Atlântico'
            altB.innerHTML = 'Atlântico e Glacial Ártico'
            altC.innerHTML = 'Índico'
            altD.innerHTML = 'Pacífico e Atlântico'

            div_confirma7.style.display = 'none'
            div_confirma8.style.display = 'flex'

        }

    }

    function confirmado8() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (D.checked) {
            acertos++        
            num.value = '9'
            pergunta.innerHTML = 'Qual o maior tamanho que um regaleco pode chegar?'

            altA.innerHTML = '10m'
            altB.innerHTML = '20m'
            altC.innerHTML = '13m'
            altD.innerHTML = '12m'

            div_confirma8.style.display = 'none'
            div_confirma9.style.display = 'flex'

        } else{
            erros++
            num.value = '9'
            pergunta.innerHTML = 'Qual o maior tamanho que um regaleco pode chegar?'

            altA.innerHTML = '10m'
            altB.innerHTML = '20m'
            altC.innerHTML = '13m'
            altD.innerHTML = '12m'

            div_confirma8.style.display = 'none'
            div_confirma9.style.display = 'flex'

        }

    }

    function confirmado9() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (D.checked) {
            acertos++        
            num.value = '10'
            pergunta.innerHTML = 'Segundo uma crença japonesa, esse peixe é um ”mensageiro do palácio do deus do mar” que anuncia acontecimentos catastróficos como terremotos e tsunamis.'

            altA.innerHTML = 'Tubarão Cobra'
            altB.innerHTML = 'Regaleco'
            altC.innerHTML = 'Lula vampiro do inferno'
            altD.innerHTML = 'Tubarão Duende'

            div_confirma9.style.display = 'none'
            div_confirma10.style.display = 'flex'

        } else{
            erros++
            num.value = '10'
            pergunta.innerHTML = 'Segundo uma crença japonesa, esse peixe é um ”mensageiro do palácio do deus do mar” que anuncia acontecimentos catastróficos como terremotos e tsunamis.'

            altA.innerHTML = 'Tubarão Cobra'
            altB.innerHTML = 'Regaleco'
            altC.innerHTML = 'Lula vampiro do inferno'
            altD.innerHTML = 'Tubarão Duende'

            div_confirma9.style.display = 'none'
            div_confirma10.style.display = 'flex'

        }

    }

    function confirmado10() {
        if (A.checked == false && B.checked == false && C.checked == false && D.checked == false) {
            alert ('Selecione uma alternativa')

        } else if (B.checked) {
            acertos++        
            num.value = ''

            pergunta.innerHTML = `Parabéns, Você terminou o quizz!!! você conseguiu acertar ${acertos} questões, ou seja, ${(acertos/10*100).toFixed(0)}%.`

            div_confirma9.style.display = 'none'
            div_confirma10.style.display = 'none'
            alterna.style.display = 'none'
            mudar_pergunta.style.display = 'none'
            analytics.style.display = 'flex'

        } else{
            erros++
            num.value = ''

            pergunta.innerHTML = `Parabéns, Você terminou o quizz!!! você conseguiu acertar ${acertos} questões, ou seja, ${(acertos/10*100).toFixed(0)}%.`

            div_confirma9.style.display = 'none'
            div_confirma10.style.display = 'none'
            alterna.style.display = 'none'
            mudar_pergunta.style.display = 'none'
            analytics.style.display = 'flex'

        }

    }

    function finalizar() {

        // setInterval(sumirMensagem, 5000)
        // Enviando o valor da nova input
        fetch("/usuarios/cadastrar_quizz", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                acertosServer: acertos,
                errosServer: erros,
                fkUsuarioServer: sessionStorage.ID_USUARIO
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                
                ranking(sessionStorage.idUsuario);  
            } else {
                throw ("Houve um erro ao tentar realizar a coleta de dados");
                
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

        return false;
    }

    function ranking(idUsuario) {

        fetch(`/usuarios/listar_ranking/${idUsuario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                console.log(response);
                response.json().then(json => {
                    console.log(json);
                    // console.log(json.length)
                    // console.log(JSON.stringify(json));
                    vt_ranking = [];
                    
                    for(let i = 0; i < json.length; i ++ ){
                        vt_ranking.push(json[i]);
                        console.log(`cadastro ${i}`)
                        // o nome de cada botao retorna assim
                        console.log(vt_ranking[i])
                    }
                    listar()
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function listar() {
        var num = 1
        pergunta.style.display = 'none'
        btn_ranking.style.display = 'none'
        analytics.innerHTML +='Ranking <br>'
        for (var i = 0; i < vt_ranking.length; i++) {
            analytics.innerHTML += `${num++}° ${vt_ranking[i].nome} acertos: ${vt_ranking[i].acertos}<br>`
        }
        num = 0
    }

    function limparSessao() {
    sessionStorage.clear();
    window.location = "login.html";
    }

</script>